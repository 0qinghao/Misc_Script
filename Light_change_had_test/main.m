blk87 = [ 
   186   186   187   187   187   187   187   187;
   187   186   187   187   187   187   187   187;
   187   188   188   187   188   188   187   187;
   188   190   190   189   189   189   188   187;
   184   189   192   189   187   187   187   187;
   195   192   192   191   189   188   188   188;
   204   201   196   194   194   194   191   190;
   192   198   201   206   202   197   192   191; ];

blk88 = [
   159   159   160   160   161   161   161   161;
   159   159   160   160   161   161   161   161;
   160   160   161   161   161   161   161   161;
   160   160   161   161   161   161   161   161;
   161   162   162   162   162   162   161   161;
   165   164   163   162   162   162   161   161;
   167   166   164   163   162   162   161   161;
   164   164   163   163   162   162   162   161; ];

had_f = [     0     7     3     4     1     6     2     5;
     7    14    10    11     8    13     9    12;
     3    10     6     7     4     9     5     8;
     4    11     7     8     5    10     6     9;
     1     8     4     5     2     7     3     6;
     6    13     9    10     7    12     8    11;
     2     9     5     6     3     8     4     7;
     5    12     8     9     6    11     7    10;];

had87 = hadamard(8)*blk87*hadamard(8)';
had88 = hadamard(8)*blk88*hadamard(8)';

dc87=abs(had87(1,1));
dc88=abs(had88(1,1));

ac87 = sum(abs(had87),[1,2])-dc87;
ac88 = sum(abs(had88),[1,2])-dc88;

midac87 = sum(abs(had87).*(had_f<=4),[1,2])-dc87
midac88 = sum(abs(had88).*(had_f<=4),[1,2])-dc88

highac87 = sum(abs(had87).*(had_f>=11),[1,2])
highac88 = sum(abs(had88).*(had_f>=11),[1,2])